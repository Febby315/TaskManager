<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>数据展示</title>
</head>
<body>
    <table>
        <thead>
            <tr>
                <td name="index">序号</td>
                <td name="articleTitle">标题</td>
                <td name="clickNum">点击量</td>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</body>
<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    $.ajax({
        type:"post",
        url:"http://192.168.2.211:3000/spiderdb/tagArticleBus/list",
        dataType:'jsonp',
        jsoup:"callback",
        timeout:3000,
        success:function(result) {
            if(result.data){
                loadTable(revise(result.data));
            }
        }
    });

    function reviseArticleUrl(url){  //校正url
        var prefix="https://m.gstzy.cn/article";    //https://m.gstzy.cn/article?id=8976&tid=307
        return prefix+url.substring(url.indexOf("?"),url.length);
    }
    function revise(data){  //校正数据
        for(var i=0;i<data.length;i++){
            data[i].index=i+1;//添加序号
            data[i].articleURL=reviseArticleUrl(data[i].articleURL);//校正文章链接
        }
        return data;
    }
    function getFileds() {  //获取字段
        var fileds={};
        $("table>thead>tr>td").each(function(index,ele){
            fileds[$(ele).attr("name")]=$(ele).text();
        });
        return fileds;
    }
    function getTrTemplet(fileds){  //获取模板
        var templet="";
        for(var k in fileds){
            if(k==="articleTitle"){
                templet+="<td><a href='#{articleURL}'>#{"+k+"}</a></td>";
            }else{
                templet+="<td>#{"+k+"}</td>";
            }
        }
        return "<tr>"+templet+"</tr>";
    }
    function renderTemplet(templet,obj){    //渲染模板
        for(var k in obj){
            templet=templet.replace(new RegExp("#{"+k+"}","g"),obj[k]);
        }
        return templet;
    }
    function loadTable(data){   //加载Table
        var fileds=getFileds();
        for(var i=0;i<data.length;i++){
            var templet=getTrTemplet(fileds);
            var trStr=renderTemplet(templet,data[i]);
            $("table>tbody").append(trStr);
        }
    }
</script>
</html>